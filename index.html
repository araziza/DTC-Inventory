<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DTC Industrial Inventory</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
        
        .login-container { min-height: 100vh; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; padding: 20px; }
        .login-box { background: white; border-radius: 10px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); padding: 40px; max-width: 400px; width: 100%; }
        .login-box h1 { font-size: 28px; color: #333; margin-bottom: 5px; }
        .login-box p { color: #666; margin-bottom: 30px; }
        .login-box input { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; margin-bottom: 20px; }
        .login-box input:focus { outline: none; ring: 2px; box-shadow: 0 0 0 3px #667eea; }
        .login-box button { width: 100%; padding: 12px; background: #667eea; color: white; border: none; border-radius: 5px; font-size: 16px; font-weight: bold; cursor: pointer; transition: background 0.3s; }
        .login-box button:hover { background: #764ba2; }
        
        .app-container { min-height: 100vh; display: none; }
        .app-container.active { display: flex; flex-direction: column; }
        
        .header { background: #667eea; color: white; padding: 16px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header-content { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .header h1 { font-size: 24px; margin-bottom: 5px; }
        .header-info { font-size: 14px; opacity: 0.9; }
        .logout-btn { background: #e74c3c; padding: 10px 20px; border: none; color: white; border-radius: 5px; cursor: pointer; font-weight: bold; }
        .logout-btn:hover { background: #c0392b; }
        
        .content { flex: 1; max-width: 1200px; margin: 0 auto; width: 100%; padding: 20px; }
        
        .mode-section { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .mode-label { font-weight: bold; margin-bottom: 15px; display: block; }
        .mode-options { display: flex; flex-wrap: wrap; gap: 20px; }
        .mode-option { display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .mode-option input[type="radio"] { cursor: pointer; }
        
        .control-section { background: white; border-radius: 8px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .control-section label { display: block; font-weight: bold; margin-bottom: 8px; font-size: 14px; }
        .control-section select, .control-section input { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px; font-size: 14px; margin-bottom: 15px; }
        .control-section select:focus, .control-section input:focus { outline: none; box-shadow: 0 0 0 3px #667eea; }
        .range-row { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .search-input { position: relative; }
        .search-input svg { position: absolute; left: 10px; top: 12px; color: #999; }
        .search-input input { padding-left: 40px; }
        
        .table-container { background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        table { width: 100%; border-collapse: collapse; }
        thead { background: #f8f9fa; }
        th { padding: 12px; text-align: left; font-weight: bold; font-size: 14px; color: #333; border-bottom: 2px solid #e0e0e0; }
        td { padding: 12px; border-bottom: 1px solid #e0e0e0; font-size: 14px; }
        tr:hover { background: #f9f9f9; }
        .qty-cell { color: #667eea; font-weight: bold; cursor: pointer; padding: 8px 12px; border-radius: 4px; }
        .qty-cell:hover { background: #f0f0ff; }
        .no-data { text-align: center; padding: 40px; color: #999; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
        .modal.active { display: flex; }
        .modal-content { background: white; border-radius: 10px; padding: 30px; max-width: 400px; width: 100%; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
        .modal h3 { margin-bottom: 20px; font-size: 18px; }
        .display { width: 100%; padding: 15px; text-align: center; font-size: 32px; font-weight: bold; border: 2px solid #ddd; border-radius: 5px; margin-bottom: 20px; background: #f9f9f9; }
        .numpad { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px; }
        .numpad-btn { padding: 15px; font-size: 18px; font-weight: bold; border: none; border-radius: 5px; cursor: pointer; transition: background 0.2s; }
        .num { background: #667eea; color: white; }
        .num:hover { background: #764ba2; }
        .num:active { transform: scale(0.95); }
        .action { padding: 12px; font-weight: bold; color: white; border: none; border-radius: 5px; cursor: pointer; }
        .back { background: #f39c12; }
        .back:hover { background: #e67e22; }
        .clear { background: #e74c3c; }
        .clear:hover { background: #c0392b; }
        .submit { background: #27ae60; width: 100%; }
        .submit:hover { background: #229954; }
        
        @media (max-width: 768px) {
            .header-content { flex-direction: column; align-items: flex-start; gap: 10px; }
            .range-row { grid-template-columns: 1fr; }
            .modal-content { width: 90%; }
        }
    </style>
</head>
<body>
    <!-- LOGIN SCREEN -->
    <div class="login-container" id="loginScreen">
        <div class="login-box">
            <h1>DTC Industrial</h1>
            <p>Physical tory Counter</p>
            <input type="text" id="userIdInput" placeholder="Enter Device/User ID" autofocus />
            <button onclick="starttory()">Start tory</button>
        </div>
    </div>

    <!-- APP SCREEN -->
    <div class="app-container" id="appContainer">
        <div class="header">
            <div class="header-content">
                <div>
                    <h1>DTC Industrial</h1>
                    <div class="header-info">User: <span id="userDisplay"></span> | Items: <span id="itemCount">0</span></div>
                </div>
                <button class="logout-btn" onclick="logout()">Logout</button>
            </div>
        </div>

        <div class="content">
            <!-- MODE SELECTION -->
            <div class="mode-section">
                <label class="mode-label">Select Entry Mode:</label>
                <div class="mode-options">
                    <label class="mode-option">
                        <input type="radio" name="mode" value="location" checked onchange="setMode('location')">
                        <span>By Location</span>
                    </label>
                    <label class="mode-option">
                        <input type="radio" name="mode" value="range" onchange="setMode('range')">
                        <span>By Range</span>
                    </label>
                    <label class="mode-option">
                        <input type="radio" name="mode" value="part" onchange="setMode('part')">
                        <span>By Part</span>
                    </label>
                </div>
            </div>

            <!-- CONTROLS -->
            <div class="control-section" id="locationControl">
                <label>Select Location:</label>
                <select id="locationSelect" onchange="displayData()">
                    <option value="">-- Choose Location --</option>
                </select>
            </div>

            <div class="control-section" id="rangeControl" style="display: none;">
                <div class="range-row">
                    <div>
                        <label>From Part #:</label>
                        <input type="text" id="rangeStart" placeholder="e.g., B00738" onchange="displayData()" />
                    </div>
                    <div>
                        <label>To Part #:</label>
                        <input type="text" id="rangeEnd" placeholder="e.g., B00900" onchange="displayData()" />
                    </div>
                </div>
            </div>

            <div class="control-section" id="partControl" style="display: none;">
                <label>Search Part:</label>
                <div class="search-input">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><path d="M9 17C13.4183 17 17 13.4183 17 9C17 4.58172 13.4183 1 9 1C4.58172 1 1 4.58172 1 9C1 13.4183 4.58172 17 9 17ZM19 19L13.6 13.6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
                    <input type="text" id="partSearch" placeholder="Enter part # or description" oninput="displayData()" />
                </div>
            </div>

            <!-- TABLE -->
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            <th>Part #</th>
                            <th>Description</th>
                            <th>QTY</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <tr><td colspan="3" class="no-data">No items to display</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- NUMBER PAD MODAL -->
    <div class="modal" id="numberPadModal">
        <div class="modal-content">
            <h3 id="partCodeDisplay">B00738</h3>
            <div class="display" id="numberDisplay">0</div>
            <div class="numpad">
                <button class="numpad-btn num" onclick="addNumber('1')">1</button>
                <button class="numpad-btn num" onclick="addNumber('2')">2</button>
                <button class="numpad-btn num" onclick="addNumber('3')">3</button>
                <button class="numpad-btn num" onclick="addNumber('4')">4</button>
                <button class="numpad-btn num" onclick="addNumber('5')">5</button>
                <button class="numpad-btn num" onclick="addNumber('6')">6</button>
                <button class="numpad-btn num" onclick="addNumber('7')">7</button>
                <button class="numpad-btn num" onclick="addNumber('8')">8</button>
                <button class="numpad-btn num" onclick="addNumber('9')">9</button>
            </div>
            <div class="numpad">
                <button class="numpad-btn num" onclick="addNumber('0')">0</button>
                <button class="numpad-btn action back" onclick="backspace()">← Back</button>
                <button class="numpad-btn action clear" onclick="clearNumber()">Clear</button>
            </div>
            <button class="numpad-btn action submit" onclick="submitQuantity()">Submit</button>
        </div>
    </div>

    <script>
        // ============ DATA ============
        // IMPORTANT: Replace this with your full 120,000 row JSON data
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwyJKwLNNlAcDa_hoUouUrS4aGJ9ZzfG7YZZj4Xn8yL26qtFegIGidCdq5Nvd-c2-zaUQ/exec';
        let inventoryData = [];
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwyJKwLNNlAcDa_hoUouUrS4aGJ9ZzfG7YZZj4Xn8yL26qtFegIGidCdq5Nvd-c2-zaUQ/exec';

        // Load data when page loads
        fetch(SCRIPT_URL)
          .then(response => response.json())
          .then(data => {
            inventoryData = data;
            document.getElementById('itemCount').textContent = inventoryData.length;
            if (currentUser) {
              populateLocations();
              displayData();
            }
          })
          .catch(err => console.error('Failed to load data:', err));

        let transactions = {};
        let currentUser = '';
        let currentMode = 'location';
        let currentPartCode = '';
        let numberPadValue = '0';

        // ============ LOGIN ============
        function startInventory() {
            const userId = document.getElementById('userIdInput').value.trim();
            if (!userId) {
                alert('Please enter a Device/User ID');
                return;
            }
            
            if (inventoryData.length === 0) {
                alert('Inventory data is still loading. Please wait a moment and try again.');
                return;
            }
            
            currentUser = userId;
            document.getElementById('userDisplay').textContent = userId;
            document.getElementById('itemCount').textContent = inventoryData.length;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('appContainer').classList.add('active');
            populateLocations();
            displayData();
            document.getElementById('userIdInput').value = '';
        }
        
        function logout() {
            currentUser = '';
            transactions = {};
            document.getElementById('appContainer').classList.remove('active');
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('userIdInput').focus();
        }

        // ============ MODE & DISPLAY ============
        function setMode(mode) {
            currentMode = mode;
            document.getElementById('locationControl').style.display = mode === 'location' ? 'block' : 'none';
            document.getElementById('rangeControl').style.display = mode === 'range' ? 'block' : 'none';
            document.getElementById('partControl').style.display = mode === 'part' ? 'block' : 'none';
            displayData();
        }

        function populateLocations() {
            const locations = [...new Set(inventoryData
                .map(item => item.Location)
                .filter(loc => loc && loc !== 0 && loc !== 'Not Found' && loc !== '')
            )].sort();
            
            const select = document.getElementById('locationSelect');
            select.innerHTML = '<option value="">-- Choose Location --</option>';
            locations.forEach(loc => {
                const option = document.createElement('option');
                option.value = loc;
                option.textContent = loc;
                select.appendChild(option);
            });
        }

        function displayData() {
            let filtered = [];

            if (currentMode === 'location') {
                const loc = document.getElementById('locationSelect').value;
                if (loc) filtered = inventoryData.filter(item => item.Location == loc);
            } else if (currentMode === 'range') {
                const start = document.getElementById('rangeStart').value.toUpperCase();
                const end = document.getElementById('rangeEnd').value.toUpperCase();
                if (start && end) {
                    const sorted = [...inventoryData].sort((a, b) => (a.Product_Code || '').localeCompare(b.Product_Code || ''));
                    const startIdx = sorted.findIndex(item => (item.Product_Code || '').localeCompare(start) >= 0);
                    const endIdx = sorted.findIndex(item => (item.Product_Code || '').localeCompare(end) > 0);
                    filtered = startIdx >= 0 ? sorted.slice(startIdx, endIdx >= 0 ? endIdx : sorted.length) : [];
                }
            } else if (currentMode === 'part') {
                const search = document.getElementById('partSearch').value.toUpperCase();
                if (search) {
                    filtered = inventoryData.filter(item =>
                        (item.Product_Code || '').toUpperCase().includes(search) ||
                        (item.Product_Code_Description || '').toUpperCase().includes(search)
                    );
                }
            }

            const tbody = document.getElementById('tableBody');
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" class="no-data">No items to display</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map(item => `
                <tr>
                    <td>${item.Product_Code}</td>
                    <td>${item.Product_Code_Description}</td>
                    <td class="qty-cell" onclick="openNumberPad('${item.Product_Code}')">${transactions[item.Product_Code] || '—'}</td>
                </tr>
            `).join('');
        }

        // ============ NUMBER PAD ============
        function openNumberPad(partCode) {
            currentPartCode = partCode;
            numberPadValue = (transactions[partCode] || '0').toString();
            document.getElementById('partCodeDisplay').textContent = partCode;
            document.getElementById('numberDisplay').textContent = numberPadValue;
            document.getElementById('numberPadModal').classList.add('active');
        }

        function addNumber(num) {
            if (numberPadValue === '0') numberPadValue = '';
            numberPadValue += num;
            document.getElementById('numberDisplay').textContent = numberPadValue;
        }

        function backspace() {
            numberPadValue = numberPadValue.slice(0, -1) || '0';
            document.getElementById('numberDisplay').textContent = numberPadValue;
        }

        function clearNumber() {
            numberPadValue = '0';
            document.getElementById('numberDisplay').textContent = numberPadValue;
        }

        function submitQuantity() {
            transactions[currentPartCode] = parseInt(numberPadValue) || 0;
            document.getElementById('numberPadModal').classList.remove('active');
            displayData();
        }

        // Initialize
        document.getElementById('userIdInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') startInventory();
        });
    </script>
</body>
</html>



